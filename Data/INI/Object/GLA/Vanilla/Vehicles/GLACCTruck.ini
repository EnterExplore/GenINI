Object GLAVehicleCommandTruck
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    ConditionState = MOVING
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = LOOP
    End
    ConditionState = REALLYDAMAGED
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = MANUAL
    End
    ConditionState = REALLYDAMAGED MOVING
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = LOOP
    End
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeLight
      ParticleSysBone = EXHAUST02 DozerSmokeLight
    End
    ConditionState = MOVING
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeHeavy
      ParticleSysBone = EXHAUST02 DozerSmokeHeavy
    End
  End

  Draw = W3DTruckDraw ModuleTag_BusArmor01
    DefaultConditionState
      Model = UVBattBus_S
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = MOVING
    AliasConditionState = MOVING REALLYDAMAGED
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End
    
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLA
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusPassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 200

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = GLAVehicleCommandTruckCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK VEHICLE SALVAGER TRANSPORT SCORE IGNORES_SELECT_ALL COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE HERO DRONE ;no hijacks

  Body = ActiveBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1000.0
    InitialHealth       = 1000.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End
  Locomotor = SET_NORMAL GLACommandTruckLocomotor

  Behavior = PhysicsBehavior ModuleTag_05
    Mass = 130.0
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL -SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckNormalDeath
    FX  = FINAL FX_BuggyNewDeathExplosion
  End

  Behavior = SlowDeathBehavior ModuleTag_123456
    DeathTypes       = NONE +SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeath
    FX  = FINAL FX_BattleBusStartUndeath
  End

  Behavior = TransportContain  ModuleTag_10
    PassengersAllowedToFire = Yes
    Slots                   = 10
    DamagePercentToUnits    = 0%
    AllowInsideKindOf       = INFANTRY
    ForbidInsideKindOf      = NO_GARRISON
    ExitDelay               = 250
    NumberOfExitPaths       = 5 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
    GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
    WeaponBonusPassedToPassengers = No
    DelayExitInAir                = Yes
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckCommandSet
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

   Behavior           = OCLSpecialPower ModuleTag_Science00
     SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
     OCL                  = SUPERWEAPON_HijackerStrike
     ReferenceObject      = ScavangedSalvageDecalObject
     CreateLocation       = CREATE_AT_LOCATION
   End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_RebelAmbush3 SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_RebelAmbush2 SUPERWEAPON_RebelAmbush2
    OCL                  = SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_GammaUpgrade SUPERWEAPON_AnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGPSScrambler
    UpgradeOCL           = SCIENCE_GPSScramblerV3 SUPERWEAPON_GPSScramblerV3
    UpgradeOCL           = SCIENCE_GPSScramblerV2 SUPERWEAPON_GPSScramblerV2
    OCL                  = SUPERWEAPON_GPSScrambler
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponMineTrap
    OCL                  = SUPERWEAPON_GLAMineTrapStart
    ReferenceObject      = GLAMineTrap
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science08
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science11
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior           = OCLSpecialPower ModuleTag_Sandworm01
    SpecialPowerTemplate = SuperweaponSandworm
    OCL                  = SUPERWEAPON_ShaiHulud
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_AnthraxBombIconUpdate01
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End
  Behavior = GrantScienceUpgrade ModuleTag_AnthraxBombIconUpdate02
    GrantScience = SCIENCE_AnthraxBomb_GammaUpgrade
    TriggeredBy = Chem_Upgrade_GLAAnthraxGamma
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length

End

Object GLAVehicleCommandTruck_Stationary
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    IgnoreConditionStates = SNOW

    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1_D1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
    End
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade01
    AttachToBoneInAnotherModule = EXITEND04
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW1_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW1_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade02
    AttachToBoneInAnotherModule = EXITEND02
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW3s_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW3s_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade03
    AttachToBoneInAnotherModule = EXITEND05
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = PMTire_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLA
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusStructurePassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 300

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = GLAVehicleCommandTruckCommandSet_Stationary

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK STRUCTURE IMMOBILE SALVAGER SCORE COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE AUTO_RALLYPOINT GARRISONABLE_UNTIL_DESTROYED IMMUNE_TO_CAPTURE HERO DRONE ;no hijacks

  Body = StructureBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1200.0
    InitialHealth       = 1200.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = DefaultProductionExitUpdate ModuleTag_12341
    UnitCreatePoint   = X: 3.0  Y:0.0   Z:0.0
    NaturalRallyPoint = X: 0.0  Y:15.0  Z:0.0 ;NaturalRallyPointX must always match GeometryMajorRadius! -ML
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeathFinal
    FX  = FINAL FX_BuggyNewDeathExplosion
  End

  Behavior = GarrisonContain ModuleTag_08
    ContainMax                    = 10
    DamagePercentToUnits          = 0%
    IsEnclosingContainer          = Yes
    EnterSound                    = POWTruckEnter
    ExitSound                     = POWTruckExit
    ImmuneToClearBuildingAttacks  = Yes
    ForbidInsideKindOf            = BOAT NO_GARRISON
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckCommandSet_Stationary
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

   Behavior           = OCLSpecialPower ModuleTag_Science00
     SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
     OCL                  = SUPERWEAPON_HijackerStrike
     ReferenceObject      = ScavangedSalvageDecalObject
     CreateLocation       = CREATE_AT_LOCATION
   End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_RebelAmbush3 SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_RebelAmbush2 SUPERWEAPON_RebelAmbush2
    OCL                  = SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_GammaUpgrade SUPERWEAPON_AnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGPSScrambler
    UpgradeOCL           = SCIENCE_GPSScramblerV3 SUPERWEAPON_GPSScramblerV3
    UpgradeOCL           = SCIENCE_GPSScramblerV2 SUPERWEAPON_GPSScramblerV2
    OCL                  = SUPERWEAPON_GPSScrambler
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponMineTrap
    OCL                  = SUPERWEAPON_GLAMineTrapStart
    ReferenceObject      = GLAMineTrap
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science08
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science11
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_AnthraxBombIconUpdate01
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End
  Behavior = GrantScienceUpgrade ModuleTag_AnthraxBombIconUpdate02
    GrantScience = SCIENCE_AnthraxBomb_GammaUpgrade
    TriggeredBy = Chem_Upgrade_GLAAnthraxGamma
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length
End



;*********************************************
; DEMO
;*********************************************

Object Demo_GLAVehicleCommandTruck
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    ConditionState = MOVING
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = LOOP
    End
    ConditionState = REALLYDAMAGED
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = MANUAL
    End
    ConditionState = REALLYDAMAGED MOVING
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = LOOP
    End
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeLight
      ParticleSysBone = EXHAUST02 DozerSmokeLight
    End
    ConditionState = MOVING
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeHeavy
      ParticleSysBone = EXHAUST02 DozerSmokeHeavy
    End
  End

  Draw = W3DTruckDraw ModuleTag_BusArmor01
    DefaultConditionState
      Model = UVBattBus_S
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = MOVING
    AliasConditionState = MOVING REALLYDAMAGED
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End   
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLADemolitionGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusPassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 200

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Demo_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Demo_GLAVehicleCommandTruckCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK VEHICLE SALVAGER TRANSPORT SCORE IGNORES_SELECT_ALL COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE HERO DRONE ;no hijacks

  Body = ActiveBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1000.0
    InitialHealth       = 1000.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End
  Locomotor = SET_NORMAL GLACommandTruckLocomotor

  Behavior = PhysicsBehavior ModuleTag_05
    Mass = 130.0
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  ;Generic blow up when ded
  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL -SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckNormalDeath
    FX  = FINAL FX_BuggyNewDeathExplosion
  End
  ;Turned into bunker; ejects passengers.
  Behavior = SlowDeathBehavior ModuleTag_123456
    DeathTypes       = NONE +SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeath_Demo
    FX  = FINAL FX_BattleBusStartUndeath
  End

  Behavior = TransportContain  ModuleTag_10
    PassengersAllowedToFire = Yes
    Slots                   = 10
    DamagePercentToUnits    = 0%
    AllowInsideKindOf       = INFANTRY
    ForbidInsideKindOf      = NO_GARRISON
    ExitDelay               = 250
    NumberOfExitPaths       = 5 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
    GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
    WeaponBonusPassedToPassengers = No
    DelayExitInAir                = Yes
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Demo_GLAVehicleCommandTruckCommandSet
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

   Behavior           = OCLSpecialPower ModuleTag_Science00
     SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
     OCL                  = SUPERWEAPON_HijackerStrike
     ReferenceObject      = ScavangedSalvageDecalObject
     CreateLocation       = CREATE_AT_LOCATION
   End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = Demo_SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_TerroristAmbush3 Demo_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_TerroristAmbush2 Demo_SUPERWEAPON_RebelAmbush2
    OCL                  = Demo_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLADemoParaBombing
    UpgradeOCL           = SCIENCE_GLADemoTrapParaBombingLvl3 SUPERWEAPON_DemoParaBombing3
    UpgradeOCL           = SCIENCE_GLADemoTrapParaBombingLvl2 SUPERWEAPON_DemoParaBombing2
    OCL                  = SUPERWEAPON_DemoParaBombing1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponBlackMarketNuke
    OCL                  = SUPERWEAPON_BlackMarketNuke
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    CreateLocation       = CREATE_AT_LOCATION
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science12
    SpecialPowerTemplate = SuperweaponGLABarrelBombingRun
    OCL                  = SUPERWEAPON_GLABarrelBombing
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  ; DemoGen gets free booby trap power.
  Behavior = GrantUpgradeCreate ModuleTag_Science13
    UpgradeToGrant    = Upgrade_GLAInfantryRebelBoobyTrapAttack
    ExemptStatus      = UNDER_CONSTRUCTION
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_DeathHand01
    SpecialPowerTemplate = SuperweaponGLADeathHandStrike
    OCL                  = SUPERWEAPON_CommandBusDeathHandMissile
    CreateLocation       = CREATE_AT_EDGE_FARTHEST_FROM_TARGET
  End

  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length

End

Object Demo_GLAVehicleCommandTruck_Stationary
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1_D1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
    End
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
  
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade01
    AttachToBoneInAnotherModule = EXITEND04
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW1_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW1_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade02
    AttachToBoneInAnotherModule = EXITEND02
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW3s_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW3s_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade03
    AttachToBoneInAnotherModule = EXITEND05
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = PMTire_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLADemolitionGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusStructurePassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 300

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Demo_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Demo_GLAVehicleCommandTruckCommandSet_Stationary

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK STRUCTURE IMMOBILE SALVAGER SCORE COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE AUTO_RALLYPOINT GARRISONABLE_UNTIL_DESTROYED IMMUNE_TO_CAPTURE HERO DRONE ;no hijacks

  Body = StructureBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1200.0
    InitialHealth       = 1200.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = DefaultProductionExitUpdate ModuleTag_12341
    UnitCreatePoint   = X: 3.0  Y:0.0   Z:0.0
    NaturalRallyPoint = X: 0.0  Y:15.0  Z:0.0 ;NaturalRallyPointX must always match GeometryMajorRadius! -ML
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeathFinal
    FX  = FINAL FX_BattleBusHitGround
  End

  Behavior = GarrisonContain ModuleTag_08
    ContainMax                    = 10
    DamagePercentToUnits          = 0%
    IsEnclosingContainer          = Yes
    EnterSound                    = POWTruckEnter
    ExitSound                     = POWTruckExit
    ImmuneToClearBuildingAttacks  = Yes
    ForbidInsideKindOf            = BOAT NO_GARRISON
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Demo_GLAVehicleCommandTruckCommandSet_Stationary
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

   Behavior           = OCLSpecialPower ModuleTag_Science00
     SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
     OCL                  = SUPERWEAPON_HijackerStrike
     ReferenceObject      = ScavangedSalvageDecalObject
     CreateLocation       = CREATE_AT_LOCATION
   End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = Demo_SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_TerroristAmbush3 Demo_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_TerroristAmbush2 Demo_SUPERWEAPON_RebelAmbush2
    OCL                  = Demo_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLADemoParaBombing
    UpgradeOCL           = SCIENCE_GLADemoTrapParaBombingLvl3 SUPERWEAPON_DemoParaBombing3
    UpgradeOCL           = SCIENCE_GLADemoTrapParaBombingLvl2 SUPERWEAPON_DemoParaBombing2
    OCL                  = SUPERWEAPON_DemoParaBombing1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponBlackMarketNuke
    OCL                  = SUPERWEAPON_BlackMarketNuke
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    CreateLocation       = CREATE_AT_LOCATION
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science12
    SpecialPowerTemplate = SuperweaponGLABarrelBombingRun
    OCL                  = SUPERWEAPON_GLABarrelBombing
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  ; DemoGen gets free booby trap power.
  Behavior = GrantUpgradeCreate ModuleTag_Science13
    UpgradeToGrant    = Upgrade_GLAInfantryRebelBoobyTrapAttack
    ExemptStatus      = UNDER_CONSTRUCTION
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length
End

;*********************************************
;*********************************************
; STEALTH
;*********************************************
;*********************************************

Object Slth_GLAVehicleCommandTruck
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    ConditionState = MOVING
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = LOOP
    End
    ConditionState = REALLYDAMAGED
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = MANUAL
    End
    ConditionState = REALLYDAMAGED MOVING
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = LOOP
    End
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeLight
      ParticleSysBone = EXHAUST02 DozerSmokeLight
    End
    ConditionState = MOVING
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeHeavy
      ParticleSysBone = EXHAUST02 DozerSmokeHeavy
    End
  End

  Draw = W3DTruckDraw ModuleTag_BusArmor01
    DefaultConditionState
      Model = UVBattBus_S
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = MOVING
    AliasConditionState = MOVING REALLYDAMAGED
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLAStealthGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusPassengerDummyWeapon
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 200

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Slth_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Slth_GLAVehicleCommandTruckCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK VEHICLE SALVAGER TRANSPORT SCORE IGNORES_SELECT_ALL COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE HERO DRONE ;no hijacks

  Body = ActiveBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1000.0
    InitialHealth       = 1000.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End
  Locomotor = SET_NORMAL GLACommandTruckLocomotor

  Behavior = PhysicsBehavior ModuleTag_05
    Mass = 130.0
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  ;Generic blow up when ded
  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL -SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckNormalDeath
    FX  = FINAL FX_BuggyNewDeathExplosion
  End
  ;Turned into bunker; ejects passengers.
  Behavior = SlowDeathBehavior ModuleTag_123456
    DeathTypes       = NONE +SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeath_Slth
    FX  = FINAL FX_BattleBusStartUndeath
  End

  Behavior = TransportContain  ModuleTag_10
    PassengersAllowedToFire = Yes
    Slots                   = 10
    DamagePercentToUnits    = 0%
    AllowInsideKindOf       = INFANTRY
    ForbidInsideKindOf      = NO_GARRISON
    ExitDelay               = 250
    NumberOfExitPaths       = 5 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
    GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
    WeaponBonusPassedToPassengers = No
    DelayExitInAir                = Yes
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Slth_GLAVehicleCommandTruckCommandSet
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

   Behavior           = OCLSpecialPower ModuleTag_Science00
     SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
     OCL                  = SUPERWEAPON_HijackerStrike
     ReferenceObject      = ScavangedSalvageDecalObject
     CreateLocation       = CREATE_AT_LOCATION
   End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_RebelAmbush3 Slth_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_RebelAmbush2 Slth_SUPERWEAPON_RebelAmbush2
    OCL                  = Slth_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = Slth_SuperweaponGPSScrambler
    UpgradeOCL           = Slth_SCIENCE_GPSScramblerV3 SUPERWEAPON_GPSScramblerV3
    UpgradeOCL           = Slth_SCIENCE_GPSScramblerV2 SUPERWEAPON_GPSScramblerV2
    OCL                  = Slth_SUPERWEAPON_GPSScrambler
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior = CashBountyPower ModuleTag_Science07
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior           = OCLSpecialPower ModuleTag_Science10
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponGLABarrelBombingRun
    OCL                  = SUPERWEAPON_GLABarrelBombing
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End

  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length

End

Object Slth_GLAVehicleCommandTruck_Stationary
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1_D1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
    End
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
  
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade01
    AttachToBoneInAnotherModule = EXITEND04
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW1_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW1_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade02
    AttachToBoneInAnotherModule = EXITEND02
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW3s_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW3s_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade03
    AttachToBoneInAnotherModule = EXITEND05
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = PMTire_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLAStealthGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusStructurePassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 300

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Slth_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Slth_GLAVehicleCommandTruckCommandSet_Stationary

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK STRUCTURE IMMOBILE SALVAGER SCORE COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE AUTO_RALLYPOINT GARRISONABLE_UNTIL_DESTROYED IMMUNE_TO_CAPTURE HERO DRONE ;no hijacks

  Body = StructureBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1200.0
    InitialHealth       = 1200.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = DefaultProductionExitUpdate ModuleTag_12341
    UnitCreatePoint   = X: 3.0  Y:0.0   Z:0.0
    NaturalRallyPoint = X: 0.0  Y:15.0  Z:0.0 ;NaturalRallyPointX must always match GeometryMajorRadius! -ML
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeathFinal
    FX  = FINAL FX_BattleBusHitGround
  End

  Behavior = GarrisonContain ModuleTag_08
    ContainMax                    = 10
    DamagePercentToUnits          = 0%
    IsEnclosingContainer          = Yes
    EnterSound                    = POWTruckEnter
    ExitSound                     = POWTruckExit
    ImmuneToClearBuildingAttacks  = Yes
    ForbidInsideKindOf            = BOAT NO_GARRISON
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Slth_GLAVehicleCommandTruckCommandSet_Stationary
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Science00
    SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
    OCL                  = SUPERWEAPON_HijackerStrike
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponRebelAmbush
    UpgradeOCL           = SCIENCE_RebelAmbush3 Slth_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = SCIENCE_RebelAmbush2 Slth_SUPERWEAPON_RebelAmbush2
    OCL                  = Slth_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = Slth_SuperweaponGPSScrambler
    UpgradeOCL           = Slth_SCIENCE_GPSScramblerV3 SUPERWEAPON_GPSScramblerV3
    UpgradeOCL           = Slth_SCIENCE_GPSScramblerV2 SUPERWEAPON_GPSScramblerV2
    OCL                  = Slth_SUPERWEAPON_GPSScrambler
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior = CashBountyPower ModuleTag_Science07
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior           = OCLSpecialPower ModuleTag_Science10
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponGLABarrelBombingRun
    OCL                  = SUPERWEAPON_GLABarrelBombing
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End

  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length
End

;*********************************************
;*********************************************
; DR. THRAX
;*********************************************
;*********************************************

Object Chem_GLAVehicleCommandTruck
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    ConditionState = MOVING
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = LOOP
    End
    ConditionState = REALLYDAMAGED
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = MANUAL
    End
    ConditionState = REALLYDAMAGED MOVING
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = LOOP
    End
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeLight
      ParticleSysBone = EXHAUST02 DozerSmokeLight
    End
    ConditionState = MOVING
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeHeavy
      ParticleSysBone = EXHAUST02 DozerSmokeHeavy
    End
  End

  Draw = W3DTruckDraw ModuleTag_BusArmor01
    DefaultConditionState
      Model = UVBattBus_S
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = MOVING
    AliasConditionState = MOVING REALLYDAMAGED
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLAToxinGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusPassengerDummyWeapon
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 200

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Chem_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Chem_GLAVehicleCommandTruckCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK VEHICLE SALVAGER TRANSPORT SCORE IGNORES_SELECT_ALL COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE HERO DRONE ;no hijacks

  Body = ActiveBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1000.0
    InitialHealth       = 1000.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End
  Locomotor = SET_NORMAL GLACommandTruckLocomotor

  Behavior = PhysicsBehavior ModuleTag_05
    Mass = 130.0
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  ;Generic blow up when ded
  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL -SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckNormalDeath
    FX  = FINAL FX_BuggyNewDeathExplosion
  End
  ;Turned into bunker; ejects passengers.
  Behavior = SlowDeathBehavior ModuleTag_123456
    DeathTypes       = NONE +SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeath_Chem
    FX  = FINAL FX_BattleBusStartUndeath
  End

  Behavior = TransportContain  ModuleTag_10
    PassengersAllowedToFire = Yes
    Slots                   = 10
    DamagePercentToUnits    = 0%
    AllowInsideKindOf       = INFANTRY
    ForbidInsideKindOf      = NO_GARRISON
    ExitDelay               = 250
    NumberOfExitPaths       = 5 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
    GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
    WeaponBonusPassedToPassengers = No
    DelayExitInAir                = Yes
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Chem_GLAVehicleCommandTruckCommandSet
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = Chem_SuperweaponRebelAmbush
    UpgradeOCL           = Chem_SCIENCE_RebelAmbush3 Chem_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = Chem_SCIENCE_RebelAmbush2 Chem_SUPERWEAPON_RebelAmbush2
    OCL                  = Chem_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_GammaUpgrade SUPERWEAPON_AnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    CreateLocation       = CREATE_AT_LOCATION
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science07
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior    = OCLSpecialPower ModuleTag_Science10
    SpecialPowerTemplate = SuperweaponCropDustah
    OCL                  = SUPERWEAPON_CropDustah1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End
  Behavior = GrantScienceUpgrade ModuleTag_Science13
    GrantScience = SCIENCE_AnthraxBomb_GammaUpgrade
    TriggeredBy = Chem_Upgrade_GLAAnthraxGamma
  End

  Behavior           = OCLSpecialPower ModuleTag_OmegaAnthrax01
    SpecialPowerTemplate = SuperweaponAnthraxOmegaBomb
    OCL                  = SUPERWEAPON_AnthraxOmegaDrop
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
    OCLAdjustPositionToPassable = No ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End 

  Behavior           = OCLSpecialPower ModuleTag_PlagueFist01
    SpecialPowerTemplate = SuperweaponPlagueFist
    OCL                  = SUPERWEAPON_PlagueFistStrike
    CreateLocation       = CREATE_AT_EDGE_FARTHEST_FROM_TARGET
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length

End

Object Chem_GLAVehicleCommandTruck_Stationary
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1_D1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
    End
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
  
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade01
    AttachToBoneInAnotherModule = EXITEND04
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW1_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW1_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade02
    AttachToBoneInAnotherModule = EXITEND02
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW3s_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW3s_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade03
    AttachToBoneInAnotherModule = EXITEND05
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = PMTire_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLAToxinGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusStructurePassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 300

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Chem_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Chem_GLAVehicleCommandTruckCommandSet_Stationary

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK STRUCTURE IMMOBILE SALVAGER SCORE COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE AUTO_RALLYPOINT GARRISONABLE_UNTIL_DESTROYED IMMUNE_TO_CAPTURE HERO DRONE ;no hijacks

  Body = StructureBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1200.0
    InitialHealth       = 1200.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = DefaultProductionExitUpdate ModuleTag_12341
    UnitCreatePoint   = X: 3.0  Y:0.0   Z:0.0
    NaturalRallyPoint = X: 0.0  Y:15.0  Z:0.0 ;NaturalRallyPointX must always match GeometryMajorRadius! -ML
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeathFinal
    FX  = FINAL FX_BattleBusHitGround
  End

  Behavior = GarrisonContain ModuleTag_08
    ContainMax                    = 10
    DamagePercentToUnits          = 0%
    IsEnclosingContainer          = Yes
    EnterSound                    = POWTruckEnter
    ExitSound                     = POWTruckExit
    ImmuneToClearBuildingAttacks  = Yes
    ForbidInsideKindOf            = BOAT NO_GARRISON
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Chem_GLAVehicleCommandTruckCommandSet_Stationary
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Science00
    SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
    OCL                  = SUPERWEAPON_HijackerStrike
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = Chem_SuperweaponRebelAmbush
    UpgradeOCL           = Chem_SCIENCE_RebelAmbush3 Chem_SUPERWEAPON_RebelAmbush3
    UpgradeOCL           = Chem_SCIENCE_RebelAmbush2 Chem_SUPERWEAPON_RebelAmbush2
    OCL                  = Chem_SUPERWEAPON_RebelAmbush1
    CreateLocation       = CREATE_AT_LOCATION
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponNerveGasBomb
    OCL                  = SUPERWEAPON_NerveGasBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_GammaUpgrade SUPERWEAPON_AnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    CreateLocation       = CREATE_AT_LOCATION
    ReferenceObject      = GLASneakAttackTunnelNetwork ;So we know what the final product is for script placement calculations
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science07
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science08
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End
  Behavior    = OCLSpecialPower ModuleTag_Science10
    SpecialPowerTemplate = SuperweaponCropDustah
    OCL                  = SUPERWEAPON_CropDustah1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science11
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End
  Behavior = GrantScienceUpgrade ModuleTag_Science13
    GrantScience = SCIENCE_AnthraxBomb_GammaUpgrade
    TriggeredBy = Chem_Upgrade_GLAAnthraxGamma
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length
End

;*********************************************
; SALVAGE
;*********************************************

Object Salv_GLAVehicleCommandTruck
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    ConditionState = MOVING
      Model = UVBBus1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = LOOP
    End
    ConditionState = REALLYDAMAGED
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = MANUAL
    End
    ConditionState = REALLYDAMAGED MOVING
      Model = UVBBus1_D
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1_D.UVBBus1_D
      AnimationMode = LOOP
    End
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeLight
      ParticleSysBone = EXHAUST02 DozerSmokeLight
    End
    ConditionState = MOVING
      Model = UVBBus1_B
      ParticleSysBone = EXHAUST01 DozerSmokeHeavy
      ParticleSysBone = EXHAUST02 DozerSmokeHeavy
    End
  End

  Draw = W3DTruckDraw ModuleTag_BusArmor01
    DefaultConditionState
      Model = UVBattBus_S
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = MOVING
    AliasConditionState = MOVING REALLYDAMAGED
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLASalvageGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusPassengerDummyWeapon
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 200

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Salv_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Salv_GLAVehicleCommandTruckCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK VEHICLE SALVAGER TRANSPORT SCORE IGNORES_SELECT_ALL COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE HERO DRONE ;no hijacks

  Body = ActiveBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1000.0
    InitialHealth       = 1000.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End
  Locomotor = SET_NORMAL GLACommandTruckLocomotor

  Behavior = PhysicsBehavior ModuleTag_05
    Mass = 130.0
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  ;Generic blow up when ded
  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL -SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckNormalDeath
    FX  = FINAL FX_BuggyNewDeathExplosion
  End
  ;Turned into bunker; ejects passengers.
  Behavior = SlowDeathBehavior ModuleTag_123456
    DeathTypes       = NONE +SUICIDED
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeath_Salv
    FX  = FINAL FX_BattleBusStartUndeath
  End

  Behavior = TransportContain  ModuleTag_10
    PassengersAllowedToFire = Yes
    Slots                   = 10
    DamagePercentToUnits    = 0%
    AllowInsideKindOf       = INFANTRY
    ForbidInsideKindOf      = NO_GARRISON
    ExitDelay               = 250
    NumberOfExitPaths       = 5 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
    GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
    WeaponBonusPassedToPassengers = No
    DelayExitInAir                = Yes
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Salv_GLAVehicleCommandTruckCommandSet
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Science00
    SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
    OCL                  = SUPERWEAPON_HijackerStrike
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponV1Strike
    OCL                  = SUPERWEAPON_V1Strike
    CreateLocation       = CREATE_AT_EDGE_FARTHEST_FROM_TARGET
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGlaPhosphorBombingRun
    UpgradeOCL           = SCIENCE_GLAPhosphorBombingRun3 SUPERWEAPON_TU2PhosphorBombingRun3
    UpgradeOCL           = SCIENCE_GLAPhosphorBombingRun2 SUPERWEAPON_TU2PhosphorBombingRun2
    OCL                  = SUPERWEAPON_TU2PhosphorBombingRun1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponGlaSalvageScavenging
    OCL                  = SUPERWEAPON_ScavengedSalvage
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science08
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science11
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_KingMarauder01
    SpecialPowerTemplate = SuperweaponKingMarauderDrop
    OCL                  = SUPERWEAPON_KingMarauderDrop
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
  End 

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End

  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length

End

Object Salv_GLAVehicleCommandTruck_Stationary
  ;
  ; *** ART Parameters ***
  SelectPortrait         = SUPOWTruck_L
  ButtonImage            = SUPOWTruck
  
  UpgradeCameo1 = Upgrade_GLAJunkRepair
  UpgradeCameo2 = Upgrade_GLACamoNetting

  Draw = W3DTruckDraw ModuleTag_01
    OkToChangeModelColor = Yes
    TrackMarks = EXTireTrack.tga
    ExtraPublicBone = BUSUP01
    ExtraPublicBone = BUSUP02
    
    DefaultConditionState
      Model = UVBBus1_D1
      ShowSubObject = BUSUP01 BUSUP02
      Animation = UVBBus1.UVBBus1
      AnimationMode = MANUAL
    End
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
    
    LeftFrontTireBone = Tire01
    RightFrontTireBone = Tire02
    LeftRearTireBone = Tire03
    RightRearTireBone = Tire04
    TireRotationMultiplier = 0.2   ; this * speed = rotation.

    Dust = RocketBuggyDust
    DirtSpray = RocketBuggyDirtSpray
    PowerslideSpray = RocketBuggyDirtPowerSlide
  End
  
  Draw = W3DTruckDraw ModuleTag_EngineSmoke01
   ConditionState = NONE
      Model = UVBBus1_B
    End
  End
  
  Draw = W3DTruckDraw ModuleTag_Headlights01
  
   DefaultConditionState
      Model = NONE
    End
    ConditionState = NIGHT
      Model = UVBBus1_N
      HideSubObject = LIGHT02
      ShowSubObject = LIGHT01
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade01
    AttachToBoneInAnotherModule = EXITEND04
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW1_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW1_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade02
    AttachToBoneInAnotherModule = EXITEND02
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = CBSandBW3s_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED

    ConditionState = RUBBLE
      Model = CBSandBW3s_E
    End
  End

  Draw = W3DModelDraw ModuleTag_Barricade03
    AttachToBoneInAnotherModule = EXITEND05
    IgnoreConditionStates = SNOW
    DefaultConditionState
      Model = PMTire_D
    End
    AliasConditionState = DAMAGED
    AliasConditionState = REALLYDAMAGED
    AliasConditionState = RUBBLE
  End
  
  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:GLACommandTruck
  Side          = GLASalvageGeneral
  EditorSorting = VEHICLE
  TransportSlotCount = 0                 ;how many "slots" we take in a transport (0 == not transportable)

  WeaponSet
    Conditions = None 
    Weapon = PRIMARY BattleBusStructurePassengerDummyWeapon
    Weapon = SECONDARY TechAirportAirStrikeWeapon
    AutoChooseSources = SECONDARY NONE
  End

  ArmorSet
    Conditions      = None
    Armor           = GLACommandTruckArmor
    DamageFX        = TankDamageFX
  End
  ArmorSet
    Conditions      = PLAYER_UPGRADE
    Armor           = DevastatorSelfDestructArmor
    DamageFX        = TankDamageFX
  End
  
  BuildCost           = 2500
  BuildTime           = 30.0          ;in seconds    
  VisionRange         = 150 ; Used in attack move targeting
  ShroudClearingRange = 300

  MaxSimultaneousOfType  = 1
  MaxSimultaneousLinkKey = CommandTruck
  
  Prerequisites
    Object = Salv_GLAPalace
  End
  
  CrusherLevel           = 2  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet = Salv_GLAVehicleCommandTruckCommandSet_Stationary

  ; *** AUDIO Parameters ***
  VoiceSelect           = BattleBusVoiceSelect
  VoiceMove             = BattleBusVoiceMove
  VoiceGuard            = BattleBusVoiceMove
  VoiceAttack           = BattleBusVoiceAttack
  SoundMoveStart        = BattleBusMoveStart
  SoundMoveStartDamaged = BattleBusMoveStart
  SoundEnter            = POWTruckEnter
  SoundExit             = POWTruckExit
  
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate             = BattleBusVoiceCreate
    TruckLandingSound       = RocketBuggyLand
    VoiceUnload             = BattleBusVoiceUnload
    DisguiseStarted         = BombTruckDisguiseStarted
    DisguiseRevealedSuccess = BombTruckDisguiseRevealedSuccess
    DisguiseRevealedFailure = BombTruckDisguiseRevealedFailure
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf        = PRELOAD SELECTABLE CAN_ATTACK STRUCTURE IMMOBILE SALVAGER SCORE COMMANDCENTER FS_FACTORY MP_COUNT_FOR_VICTORY FS_ADVANCED_TECH CANNOT_RETALIATE AUTO_RALLYPOINT GARRISONABLE_UNTIL_DESTROYED IMMUNE_TO_CAPTURE HERO DRONE ;no hijacks

  Body = StructureBody ModuleTag_02 ;Doesn't use normal battle bus features because they screw up the buttons to switch command sets
    MaxHealth           = 1200.0
    InitialHealth       = 1200.0

    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 2000
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  IsTrainable = No
  ExperienceValue    = 270 270 270 270     ;Experience point value at each level

  Behavior = TransportAIUpdate ModuleTag_04
    Turret
      TurretTurnRate = 180
      ControlledWeaponSlots = PRIMARY SECONDARY
    End
    MoodAttackCheckRate        = 33
    AutoAcquireEnemiesWhenIdle = Yes
  End

  Behavior = ProductionUpdate ModuleTag_02344
    ;nada
  End

  Behavior = DefaultProductionExitUpdate ModuleTag_12341
    UnitCreatePoint   = X: 3.0  Y:0.0   Z:0.0
    NaturalRallyPoint = X: 0.0  Y:15.0  Z:0.0 ;NaturalRallyPointX must always match GeometryMajorRadius! -ML
  End

  Behavior = AutoHealBehavior ModuleTag_06
    HealingAmount = 4
    HealingDelay = 1000 ; msec
    TriggeredBy = Upgrade_GLAJunkRepair
  End

  Behavior = SlowDeathBehavior ModuleTag_12345
    DeathTypes       = ALL
    DestructionDelay = 0
    OCL = FINAL OCL_GLACommandTruckDeathFinal
    FX  = FINAL FX_BattleBusHitGround
  End

  Behavior = GarrisonContain ModuleTag_08
    ContainMax                    = 10
    DamagePercentToUnits          = 0%
    IsEnclosingContainer          = Yes
    EnterSound                    = POWTruckEnter
    ExitSound                     = POWTruckExit
    ImmuneToClearBuildingAttacks  = Yes
    ForbidInsideKindOf            = BOAT NO_GARRISON
  End

  Behavior = StealthUpdate ModuleStealth_Stealth01
    StealthDelay                = 2500 ; msec
    StealthForbiddenConditions  = TAKING_DAMAGE RIDERS_ATTACKING
    InnateStealth               = No
    OrderIdleEnemiesToAttackMeUponReveal  = Yes
  End
  Behavior = StealthUpgrade ModuleTag_Stealth02
    TriggeredBy = Upgrade_GLACamoNetting
  END
  
  Behavior = FlammableUpdate ModuleTag_28
    AflameDuration     = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay  = 500       ; this often.
  End
  
  Behavior                 = TransitionDamageFX ModuleTag_31
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = AutoDepositUpdate ModuleTag_Tech01
    DepositTiming       = 2000   ; in milliseconds
    DepositAmount       = 50   ; cash amount to deposit every DepositTiming
    InitialCaptureBonus = 0  ; no initial bonus
  End

  ;CC Related stuff below
  ;These two modules spawn an invisible drone that is a type of STRUCTURE and MP_COUNT_FOR_VICTORY
  ;(Scenario is with 0 other buildings.) When the Mobile CC is destroyed, the invisible drone falls to the ground and then dies like a normal battle drone
  ;When the drone dies, it is the last STRUCTURE you own, and thus you lose.
  Behavior = GrantUpgradeCreate ModuleTag_StructureConditions01
    UpgradeToGrant = Upgrade_AmericaBattleDrone
  End

  Behavior = ObjectCreationUpgrade ModuleTag_StructureConditions02
    UpgradeObject = OCL_AmericaCommandTankIsStructure
    TriggeredBy   = Upgrade_AmericaBattleDrone
  End

  ;GLA TRUCK OPTIONS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers02
    TriggeredBy = Upgrade_GLAWorkerRealCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = Salv_GLAVehicleCommandTruckCommandSet_Stationary
  End

  ;TRANSPORT SLOTS
  Behavior = CommandSetUpgrade ModuleTag_CommandSetPowers03
    TriggeredBy = Upgrade_GLAWorkerFakeCommandSet
    RemovesUpgrades = Upgrade_GLAWorkerFakeCommandSet Upgrade_GLAWorkerRealCommandSet
    CommandSet = GLAVehicleCommandTruckTransportSlotsCommandSet
  End

  Behavior           = OCLSpecialPower ModuleTag_DoomsDay01
    SpecialPowerTemplate = SuperweaponSpawnLeechInfector
    OCL                  = SUPERWEAPON_LeechInfectorDrone
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Sweet01
    SpecialPowerTemplate = SuperweaponSummonSweetTooth
    OCL                  = SUPERWEAPON_SweetTooth
    OCLAdjustPositionToPassable = Yes ;Like RA2, shift target to passable cell so we don't land in water and on cliffs.
    CreateLocation       = CREATE_AT_LOCATION
  End

  Behavior           = OCLSpecialPower ModuleTag_Science00
    SpecialPowerTemplate = Gen_SuperweaponGlaHijackerStrike
    OCL                  = SUPERWEAPON_HijackerStrike
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science01
    SpecialPowerTemplate = SuperweaponGLASturmtiger
    OCL                  = SUPERWEAPON_GLASturmtiger
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science02
    SpecialPowerTemplate = SuperweaponAnthraxBomb
    UpgradeOCL           = SCIENCE_AnthraxBomb_BetaUpgrade  SUPERWEAPON_AnthraxBomb
    OCL                  = SUPERWEAPON_AnthraxBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science03
    SpecialPowerTemplate = SuperweaponEmergencyRepair
    UpgradeOCL           = SCIENCE_EmergencyRepair3 SUPERWEAPON_RepairVehicles3
    UpgradeOCL           = SCIENCE_EmergencyRepair2 SUPERWEAPON_RepairVehicles2
    OCL                  = SUPERWEAPON_RepairVehicles1
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science04
    SpecialPowerTemplate = SuperweaponSneakAttack
    OCL                  = OCL_CreateSneakAttackTunnelStart
    ReferenceObject      = GLASneakAttackTunnelNetwork
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science05
    SpecialPowerTemplate = SuperweaponV1Strike
    OCL                  = SUPERWEAPON_V1Strike
    CreateLocation       = CREATE_AT_EDGE_FARTHEST_FROM_TARGET
  End
  Behavior           = OCLSpecialPower ModuleTag_Science06
    SpecialPowerTemplate = SuperweaponGlaPhosphorBombingRun
    UpgradeOCL           = SCIENCE_GLAPhosphorBombingRun3 SUPERWEAPON_TU2PhosphorBombingRun3
    UpgradeOCL           = SCIENCE_GLAPhosphorBombingRun2 SUPERWEAPON_TU2PhosphorBombingRun2
    OCL                  = SUPERWEAPON_TU2PhosphorBombingRun1
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior           = OCLSpecialPower ModuleTag_Science07
    SpecialPowerTemplate = SuperweaponGlaSalvageScavenging
    OCL                  = SUPERWEAPON_ScavengedSalvage
    ReferenceObject      = ScavangedSalvageDecalObject
    CreateLocation       = CREATE_AT_LOCATION
  End
  Behavior           = OCLSpecialPower ModuleTag_Science08
    SpecialPowerTemplate = SuperweaponSkydiverBomb
    OCL                  = SUPERWEAPON_GLASkydiverBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End
  Behavior = CashBountyPower ModuleTag_Science09
    SpecialPowerTemplate    = SpecialAbilityCashBounty1
    Bounty                  = 15%
  End
  Behavior = CashBountyPower ModuleTag_Science10
    SpecialPowerTemplate    = SpecialAbilityCashBounty2
    Bounty                  = 30%
  End
  Behavior = CashBountyPower ModuleTag_Science11
    SpecialPowerTemplate    = SpecialAbilityCashBounty3
    Bounty                  = 45%
  End

  ;Go green
  Behavior           = OCLSpecialPower ModuleTag_PlantTree01
    SpecialPowerTemplate = SpecialAbilityPlantTree
    OCL                  = OCL_PlantTree
    ReferenceObject      = TotallyNormalTree
    CreateLocation       = CREATE_AT_LOCATION
  End

  ;This Modules grant sciences needed to upgrade the anthrax bomb icons
  Behavior = GrantScienceUpgrade ModuleTag_Science12
    GrantScience = SCIENCE_AnthraxBomb_BetaUpgrade
    TriggeredBy = Upgrade_GLAAnthraxBeta
  End
  
  Behavior           = OCLSpecialPower ModuleTag_GoodCleaner
    SpecialPowerTemplate = SuperweaponContaminationCleanseBomb
    OCL                  = SUPERWEAPON_ContaminationCleanseBomb
    CreateLocation       = CREATE_AT_EDGE_NEAR_SOURCE
  End

  Geometry = BOX
  GeometryMajorRadius = 17.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 11.5     
  GeometryIsSmall = No    
  Shadow = SHADOW_VOLUME
  ShadowSizeX = 45  ; minimum elevation angle above horizon. Used to limit shadow length
End