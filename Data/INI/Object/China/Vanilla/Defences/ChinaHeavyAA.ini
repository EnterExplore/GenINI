;Straight outta OFS
;Thanks Andi <3
Object ChinaGunBattery
  ; *** ART Parameters ***
  SelectPortrait = SNGunBattery_L
  ButtonImage = SNGunBattery

  UpgradeCameo1 = Upgrade_ChinaSubliminalMessaging

  Draw = W3DModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    IgnoreConditionStates = NIGHT
    DefaultConditionState
      Model = NBGunBattery
      Turret = Turret01
      TurretPitch = TurretEL01
      WeaponFireFXBone = PRIMARY WeaponA
      WeaponRecoilBone = PRIMARY Barrel
      WeaponLaunchBone = PRIMARY WeaponA
      ;HideSubObject = HEADLIGHT01
    End
    ConditionState = DAMAGED
      Model = NBGunBattery_D
    End
    ConditionState = REALLYDAMAGED RUBBLE
      Model = NBGunBattery_E
    End
    
    ConditionState = SNOW
      Model = NBGunBattery_S
    End
    ConditionState = DAMAGED SNOW
      Model = NBGunBattery_DS
    End
    ConditionState = REALLYDAMAGED RUBBLE SNOW
      Model = NBGunBattery_ES
    End
    
    ; **************************************************************************************************************************
    ; This block handles every possible case with construction process, selling process, awaiting construction, and sold states
    ; for this draw module
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBGunBattery
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
      Model = NBGunBattery_D
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
      Model = NBGunBattery_E
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
      Model = NBGunBattery_S
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW DAMAGED
      Model = NBGunBattery_DS
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW REALLYDAMAGED
      Model = NBGunBattery_ES
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION
      Model = NONE
    End
    AliasConditionState = AWAITING_CONSTRUCTION DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION REALLYDAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW
    AliasConditionState = AWAITING_CONSTRUCTION SNOW DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW REALLYDAMAGED
    AliasConditionState = SOLD
    AliasConditionState = SOLD DAMAGED
    AliasConditionState = SOLD REALLYDAMAGED
    AliasConditionState = SOLD SNOW
    AliasConditionState = SOLD SNOW DAMAGED
    AliasConditionState = SOLD SNOW REALLYDAMAGED
  
  End
   ; ------------ construction-zone fence -----------------
  Draw = W3DModelDraw ModuleTag_02
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ under-construction scaffolding -----------------
  Draw = W3DModelDraw ModuleTag_03
    AnimationsRequirePower = No
    MinLODRequired = MEDIUM
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = SNOW PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
      ParticleSysBone = Smoke01 BuildUpSnowSmoke
      ParticleSysBone = Smoke02 BuildUpSnowSmoke
      ParticleSysBone = Smoke03 BuildUpSnowSmoke
      ParticleSysBone = Smoke04 BuildUpSnowSmoke
    End
    ConditionState = SNOW NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
      ParticleSysBone = Smoke01 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke02 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke03 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke04 BuildUpNightSnowSmoke
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ being-constructed crane -----------------
  Draw = W3DModelDraw ModuleTag_04
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SOLD
      Model = NONE
    End
    ConditionState = ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5
      Animation = NBBunker_A5.NBBunker_A5
      AnimationMode = LOOP
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5N
      Animation = NBBunker_A5N.NBBunker_A5N
      AnimationMode = LOOP
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5S
      Animation = NBBunker_A5S.NBBunker_A5S
      AnimationMode = LOOP
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5SN
      Animation = NBBunker_A5SN.NBBunker_A5SN
      AnimationMode = LOOP
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  PlacementViewAngle = -45

  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:ChinaHeavyAA
  Side          = China
  EditorSorting = STRUCTURE

  Prerequisites
    Object = ChinaPropagandaCenter
  End

  BuildCost = 1500
  BuildTime = 30.0     ; in seconds

  EnergyProduction = -4
  ExperienceValue = 1200 1200 1200 1200 ; Experience point value at each level

  WeaponSet
    Conditions = None
    Weapon = PRIMARY ChinaGunBatteryWeapon
  End

  VisionRange = 420.0     ; Shroud clearing distance AND targeting range
  ShroudClearingRange = 420

  ArmorSet
    Conditions = None
    Armor = BaseDefenseArmor
    DamageFX = StructureDamageFXNoShake
  End

  CommandSet = ChinaGunBatteryCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect          = GazerTurretSelect
  SoundOnDamaged       = BuildingDamagedStateLight
  SoundOnReallyDamaged = BuildingDestroy
  UnitSpecificSounds
    UnderConstruction = UnderConstructionLoop
    TurretMoveStart   = NoSound
    TurretMoveLoop    = NoSound     ; These aren't playing properly (mdp) TurretMoveLoopLoud
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = STRUCTURE
  KindOf = PRELOAD STRUCTURE SELECTABLE CAN_ATTACK IMMOBILE SCORE FS_BASE_DEFENSE POWERED IMMUNE_TO_CAPTURE

  Body = StructureBody ModuleTag_05
    MaxHealth = 2500.0
    InitialHealth = 2500.0
    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 3500
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 100
  End

  Behavior = AIUpdateInterface ModuleTag_06
    Turret
      ControlledWeaponSlots = PRIMARY
      TurretTurnRate = 90     ; turn rate, in degrees per sec
      TurretPitchRate = 60
      AllowsPitch = Yes
      FiresWhileTurning = Yes
      NaturalTurretPitch = 30     ; this keeps it aimed half way between land and sky
      MinPhysicalPitch = -10
      MinIdleScanInterval = 250     ; in milliseconds
      MaxIdleScanInterval = 2500     ; in milliseconds
      MinIdleScanAngle = 0     ; in degrees off the natural turret angle
      MaxIdleScanAngle = 360     ; in degrees off the natural turret angle
    End
    AutoAcquireEnemiesWhenIdle = Yes
    MoodAttackCheckRate = 250
  End
  
  Behavior = ProductionUpdate ModuleTag_07
    ;nada
  End

  Behavior = DestroyDie ModuleTag_08
  ; nothing
  End

  Behavior = CommandSetUpgrade ModuleTag_09
    CommandSet = ChinaGunBatteryCommandSetUpgrade
    TriggeredBy = Upgrade_ChinaMines
  End

  Behavior = ArmorUpgrade ModuleTag_10
    TriggeredBy = Upgrade_ChinaEMPMines
  End

  Behavior = GenerateMinefieldBehavior ModuleTag_11
    TriggeredBy           = Upgrade_ChinaMines
    MineName              = ChinaStandardMine
    SmartBorder           = Yes
    AlwaysCircular        = Yes

    Upgradable            = Yes
    UpgradedTriggeredBy   = Upgrade_ChinaEMPMines
    UpgradedMineName      = ChinaEMPMine
  End

  Behavior = FXListDie ModuleTag_12
    DeathFX = FX_StructureTinyDeath
  End

  Behavior = CreateObjectDie ModuleTag_13
    CreationList = OCL_LargeStructureDebris
  End

  Behavior = FlammableUpdate ModuleTag_14
    AflameDuration = 5000     ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 5     ; taking this much damage...
    AflameDamageDelay = 500     ; this often.
  End

  Behavior = TransitionDamageFX ModuleTag_15
    ; -------------DESIGNED FOR TINY SIZED FACTION BUILDING TRANSITIONS-------------------
    DamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ; ---------------------------------------------------------------------------------------
    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionTinyExplosion
    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionTinyShockwave
  End

  Behavior = AutoHealBehavior ModuleTag_JunkInTheTrunk01
    HealingAmount = 2
    HealingDelay = 1000 ; msec
    StartsActive = No
    TriggeredBy = Upgrade_ChinaSubliminalMessaging
  End

  Geometry = BOX
  GeometryMajorRadius = 28.0
  GeometryMinorRadius = 28.0
  GeometryHeight = 28.0
  GeometryIsSmall = No
  Shadow = SHADOW_VOLUME
  BuildCompletion = PLACED_BY_PLAYER
End

Object Nuke_ChinaGunBattery
  ; *** ART Parameters ***
  SelectPortrait = SNGunBattery_L
  ButtonImage = SNGunBattery

  UpgradeCameo1 = Upgrade_ChinaSubliminalMessaging
  UpgradeCameo2 = Upgrade_ChinaIsotopeStability

  Draw = W3DModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    IgnoreConditionStates = NIGHT
    DefaultConditionState
      Model = NBGunBattery
      Turret = Turret01
      TurretPitch = TurretEL01
      WeaponFireFXBone = PRIMARY WeaponA
      WeaponRecoilBone = PRIMARY Barrel
      WeaponLaunchBone = PRIMARY WeaponA
      ;HideSubObject = HEADLIGHT01
    End
    ConditionState = DAMAGED
      Model = NBGunBattery_D
    End
    ConditionState = REALLYDAMAGED RUBBLE
      Model = NBGunBattery_E
    End
    
    ConditionState = SNOW
      Model = NBGunBattery_S
    End
    ConditionState = DAMAGED SNOW
      Model = NBGunBattery_DS
    End
    ConditionState = REALLYDAMAGED RUBBLE SNOW
      Model = NBGunBattery_ES
    End
    
    ; **************************************************************************************************************************
    ; This block handles every possible case with construction process, selling process, awaiting construction, and sold states
    ; for this draw module
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBGunBattery
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
      Model = NBGunBattery_D
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
      Model = NBGunBattery_E
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
      Model = NBGunBattery_S
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW DAMAGED
      Model = NBGunBattery_DS
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW REALLYDAMAGED
      Model = NBGunBattery_ES
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION
      Model = NONE
    End
    AliasConditionState = AWAITING_CONSTRUCTION DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION REALLYDAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW
    AliasConditionState = AWAITING_CONSTRUCTION SNOW DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW REALLYDAMAGED
    AliasConditionState = SOLD
    AliasConditionState = SOLD DAMAGED
    AliasConditionState = SOLD REALLYDAMAGED
    AliasConditionState = SOLD SNOW
    AliasConditionState = SOLD SNOW DAMAGED
    AliasConditionState = SOLD SNOW REALLYDAMAGED
  
  End
   ; ------------ construction-zone fence -----------------
  Draw = W3DModelDraw ModuleTag_02
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ under-construction scaffolding -----------------
  Draw = W3DModelDraw ModuleTag_03
    AnimationsRequirePower = No
    MinLODRequired = MEDIUM
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = SNOW PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
      ParticleSysBone = Smoke01 BuildUpSnowSmoke
      ParticleSysBone = Smoke02 BuildUpSnowSmoke
      ParticleSysBone = Smoke03 BuildUpSnowSmoke
      ParticleSysBone = Smoke04 BuildUpSnowSmoke
    End
    ConditionState = SNOW NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
      ParticleSysBone = Smoke01 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke02 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke03 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke04 BuildUpNightSnowSmoke
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ being-constructed crane -----------------
  Draw = W3DModelDraw ModuleTag_04
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SOLD
      Model = NONE
    End
    ConditionState = ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5
      Animation = NBBunker_A5.NBBunker_A5
      AnimationMode = LOOP
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5N
      Animation = NBBunker_A5N.NBBunker_A5N
      AnimationMode = LOOP
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5S
      Animation = NBBunker_A5S.NBBunker_A5S
      AnimationMode = LOOP
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5SN
      Animation = NBBunker_A5SN.NBBunker_A5SN
      AnimationMode = LOOP
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  PlacementViewAngle = -45

  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:ChinaHeavyAA
  Side          = ChinaNukeGeneral
  EditorSorting = STRUCTURE

  Prerequisites
    Object = Nuke_ChinaPropagandaCenter
  End

  BuildCost = 1500
  BuildTime = 30.0     ; in seconds

  EnergyProduction = -4
  ExperienceValue = 1200 1200 1200 1200 ; Experience point value at each level

  WeaponSet
    Conditions = None
    Weapon = PRIMARY ChinaGunBatteryWeapon
  End

  VisionRange = 420.0     ; Shroud clearing distance AND targeting range
  ShroudClearingRange = 420

  ArmorSet
    Conditions = None
    Armor = BaseDefenseArmor
    DamageFX = StructureDamageFXNoShake
  End

  CommandSet = ChinaGunBatteryCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect          = GazerTurretSelect
  SoundOnDamaged       = BuildingDamagedStateLight
  SoundOnReallyDamaged = BuildingDestroy
  UnitSpecificSounds
    UnderConstruction = UnderConstructionLoop
    TurretMoveStart   = NoSound
    TurretMoveLoop    = NoSound     ; These aren't playing properly (mdp) TurretMoveLoopLoud
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = STRUCTURE
  KindOf = PRELOAD STRUCTURE SELECTABLE CAN_ATTACK IMMOBILE SCORE FS_BASE_DEFENSE POWERED IMMUNE_TO_CAPTURE

  Body = StructureBody ModuleTag_05
    MaxHealth = 2500.0
    InitialHealth = 2500.0
    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 3500
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 100
  End

  Behavior = AIUpdateInterface ModuleTag_06
    Turret
      ControlledWeaponSlots = PRIMARY
      TurretTurnRate = 90     ; turn rate, in degrees per sec
      TurretPitchRate = 60
      AllowsPitch = Yes
      FiresWhileTurning = Yes
      NaturalTurretPitch = 30     ; this keeps it aimed half way between land and sky
      MinPhysicalPitch = -10
      MinIdleScanInterval = 250     ; in milliseconds
      MaxIdleScanInterval = 2500     ; in milliseconds
      MinIdleScanAngle = 0     ; in degrees off the natural turret angle
      MaxIdleScanAngle = 360     ; in degrees off the natural turret angle
    End
    AutoAcquireEnemiesWhenIdle = Yes
    MoodAttackCheckRate = 250
  End
  
  Behavior = ProductionUpdate ModuleTag_07
    ;nada
  End

  Behavior = DestroyDie ModuleTag_08
  ; nothing
  End

  Behavior = CommandSetUpgrade ModuleTag_09
    CommandSet = ChinaGunBatteryCommandSetUpgrade
    TriggeredBy = Upgrade_ChinaMines
  End

  Behavior = ArmorUpgrade ModuleTag_10
    TriggeredBy = Upgrade_ChinaEMPMines
  End

  Behavior = GenerateMinefieldBehavior ModuleTag_11
    TriggeredBy           = Upgrade_ChinaMines
    MineName              = ChinaStandardMine
    SmartBorder           = Yes
    AlwaysCircular        = Yes

    Upgradable            = Yes
    UpgradedTriggeredBy   = Upgrade_ChinaEMPMines
    UpgradedMineName      = ChinaEMPMine
  End

  Behavior = FXListDie ModuleTag_12
    DeathFX = FX_StructureTinyDeath
  End

  Behavior = CreateObjectDie ModuleTag_13
    CreationList = OCL_LargeStructureDebris
  End

  Behavior = FlammableUpdate ModuleTag_14
    AflameDuration = 5000     ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 5     ; taking this much damage...
    AflameDamageDelay = 500     ; this often.
  End

  Behavior = TransitionDamageFX ModuleTag_15
    ; -------------DESIGNED FOR TINY SIZED FACTION BUILDING TRANSITIONS-------------------
    DamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ; ---------------------------------------------------------------------------------------
    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionTinyExplosion
    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionTinyShockwave
  End

  Behavior = AutoHealBehavior ModuleTag_JunkInTheTrunk01
    HealingAmount = 2
    HealingDelay = 1000 ; msec
    StartsActive = No
    TriggeredBy = Upgrade_ChinaSubliminalMessaging
  End

  Behavior = FireWeaponWhenDeadBehavior ModuleTag_999
    DeathWeapon = ChinaPowerPlantDeathWeapon
    StartsActive  = Yes
    ConflictsWith = Upgrade_ChinaIsotopeStability
  End

  Geometry = BOX
  GeometryMajorRadius = 28.0
  GeometryMinorRadius = 28.0
  GeometryHeight = 28.0
  GeometryIsSmall = No
  Shadow = SHADOW_VOLUME
  BuildCompletion = PLACED_BY_PLAYER
End

Object Tank_ChinaGunBattery
  ; *** ART Parameters ***
  SelectPortrait = SNGunBattery_L
  ButtonImage = SNGunBattery

  UpgradeCameo1 = Upgrade_ChinaSubliminalMessaging

  Draw = W3DModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    IgnoreConditionStates = NIGHT
    DefaultConditionState
      Model = NBGunBattery
      Turret = Turret01
      TurretPitch = TurretEL01
      WeaponFireFXBone = PRIMARY WeaponA
      WeaponRecoilBone = PRIMARY Barrel
      WeaponLaunchBone = PRIMARY WeaponA
      ;HideSubObject = HEADLIGHT01
    End
    ConditionState = DAMAGED
      Model = NBGunBattery_D
    End
    ConditionState = REALLYDAMAGED RUBBLE
      Model = NBGunBattery_E
    End
    
    ConditionState = SNOW
      Model = NBGunBattery_S
    End
    ConditionState = DAMAGED SNOW
      Model = NBGunBattery_DS
    End
    ConditionState = REALLYDAMAGED RUBBLE SNOW
      Model = NBGunBattery_ES
    End
    
    ; **************************************************************************************************************************
    ; This block handles every possible case with construction process, selling process, awaiting construction, and sold states
    ; for this draw module
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBGunBattery
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
      Model = NBGunBattery_D
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
      Model = NBGunBattery_E
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
      Model = NBGunBattery_S
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW DAMAGED
      Model = NBGunBattery_DS
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW REALLYDAMAGED
      Model = NBGunBattery_ES
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION
      Model = NONE
    End
    AliasConditionState = AWAITING_CONSTRUCTION DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION REALLYDAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW
    AliasConditionState = AWAITING_CONSTRUCTION SNOW DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW REALLYDAMAGED
    AliasConditionState = SOLD
    AliasConditionState = SOLD DAMAGED
    AliasConditionState = SOLD REALLYDAMAGED
    AliasConditionState = SOLD SNOW
    AliasConditionState = SOLD SNOW DAMAGED
    AliasConditionState = SOLD SNOW REALLYDAMAGED
  
  End
   ; ------------ construction-zone fence -----------------
  Draw = W3DModelDraw ModuleTag_02
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ under-construction scaffolding -----------------
  Draw = W3DModelDraw ModuleTag_03
    AnimationsRequirePower = No
    MinLODRequired = MEDIUM
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = SNOW PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
      ParticleSysBone = Smoke01 BuildUpSnowSmoke
      ParticleSysBone = Smoke02 BuildUpSnowSmoke
      ParticleSysBone = Smoke03 BuildUpSnowSmoke
      ParticleSysBone = Smoke04 BuildUpSnowSmoke
    End
    ConditionState = SNOW NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
      ParticleSysBone = Smoke01 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke02 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke03 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke04 BuildUpNightSnowSmoke
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ being-constructed crane -----------------
  Draw = W3DModelDraw ModuleTag_04
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SOLD
      Model = NONE
    End
    ConditionState = ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5
      Animation = NBBunker_A5.NBBunker_A5
      AnimationMode = LOOP
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5N
      Animation = NBBunker_A5N.NBBunker_A5N
      AnimationMode = LOOP
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5S
      Animation = NBBunker_A5S.NBBunker_A5S
      AnimationMode = LOOP
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5SN
      Animation = NBBunker_A5SN.NBBunker_A5SN
      AnimationMode = LOOP
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  PlacementViewAngle = -45

  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:ChinaHeavyAA
  Side          = ChinaTankGeneral
  EditorSorting = STRUCTURE

  Prerequisites
    Object = Tank_ChinaPropagandaCenter
  End

  BuildCost = 1500
  BuildTime = 30.0     ; in seconds

  EnergyProduction = -4
  ExperienceValue = 1200 1200 1200 1200 ; Experience point value at each level

  WeaponSet
    Conditions = None
    Weapon = PRIMARY ChinaGunBatteryWeapon
  End

  VisionRange = 420.0     ; Shroud clearing distance AND targeting range
  ShroudClearingRange = 420

  ArmorSet
    Conditions = None
    Armor = BaseDefenseArmor
    DamageFX = StructureDamageFXNoShake
  End

  CommandSet = ChinaGunBatteryCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect          = GazerTurretSelect
  SoundOnDamaged       = BuildingDamagedStateLight
  SoundOnReallyDamaged = BuildingDestroy
  UnitSpecificSounds
    UnderConstruction = UnderConstructionLoop
    TurretMoveStart   = NoSound
    TurretMoveLoop    = NoSound     ; These aren't playing properly (mdp) TurretMoveLoopLoud
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = STRUCTURE
  KindOf = PRELOAD STRUCTURE SELECTABLE CAN_ATTACK IMMOBILE SCORE FS_BASE_DEFENSE POWERED IMMUNE_TO_CAPTURE

  Body = StructureBody ModuleTag_05
    MaxHealth = 2500.0
    InitialHealth = 2500.0
    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 3500
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 100
  End

  Behavior = AIUpdateInterface ModuleTag_06
    Turret
      ControlledWeaponSlots = PRIMARY
      TurretTurnRate = 90     ; turn rate, in degrees per sec

      TurretPitchRate = 60
      AllowsPitch = Yes
      FiresWhileTurning = Yes
      NaturalTurretPitch = 30     ; this keeps it aimed half way between land and sky
      MinPhysicalPitch = -10
      MinIdleScanInterval = 250     ; in milliseconds
      MaxIdleScanInterval = 2500     ; in milliseconds
      MinIdleScanAngle = 0     ; in degrees off the natural turret angle
      MaxIdleScanAngle = 360     ; in degrees off the natural turret angle
    End
    AutoAcquireEnemiesWhenIdle = Yes
    MoodAttackCheckRate = 250
  End
  
  Behavior = ProductionUpdate ModuleTag_07
    ;nada
  End

  Behavior = DestroyDie ModuleTag_08
  ; nothing
  End

  Behavior = CommandSetUpgrade ModuleTag_09
    CommandSet = ChinaGunBatteryCommandSetUpgrade
    TriggeredBy = Upgrade_ChinaMines
  End

  Behavior = ArmorUpgrade ModuleTag_10
    TriggeredBy = Upgrade_ChinaEMPMines
  End

  Behavior = GenerateMinefieldBehavior ModuleTag_11
    TriggeredBy           = Upgrade_ChinaMines
    MineName              = ChinaStandardMine
    SmartBorder           = Yes
    AlwaysCircular        = Yes

    Upgradable            = Yes
    UpgradedTriggeredBy   = Upgrade_ChinaEMPMines
    UpgradedMineName      = ChinaEMPMine
  End

  Behavior = FXListDie ModuleTag_12
    DeathFX = FX_StructureTinyDeath
  End

  Behavior = CreateObjectDie ModuleTag_13
    CreationList = OCL_LargeStructureDebris
  End

  Behavior = FlammableUpdate ModuleTag_14
    AflameDuration = 5000     ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 5     ; taking this much damage...
    AflameDamageDelay = 500     ; this often.
  End

  Behavior = TransitionDamageFX ModuleTag_15
    ; -------------DESIGNED FOR TINY SIZED FACTION BUILDING TRANSITIONS-------------------
    DamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ; ---------------------------------------------------------------------------------------
    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionTinyExplosion
    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionTinyShockwave
  End

  Behavior = AutoHealBehavior ModuleTag_JunkInTheTrunk01
    HealingAmount = 2
    HealingDelay = 1000 ; msec
    StartsActive = No
    TriggeredBy = Upgrade_ChinaSubliminalMessaging
  End

  Geometry = BOX
  GeometryMajorRadius = 28.0
  GeometryMinorRadius = 28.0
  GeometryHeight = 28.0
  GeometryIsSmall = No
  Shadow = SHADOW_VOLUME
  BuildCompletion = PLACED_BY_PLAYER
End

Object Infa_ChinaGunBattery
  ; *** ART Parameters ***
  SelectPortrait = SNGunBattery_L
  ButtonImage = SNGunBattery

  UpgradeCameo1 = Upgrade_ChinaSubliminalMessaging

  Draw = W3DModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    IgnoreConditionStates = NIGHT
    DefaultConditionState
      Model = NBGunBattery
      Turret = Turret01
      TurretPitch = TurretEL01
      WeaponFireFXBone = PRIMARY WeaponA
      WeaponRecoilBone = PRIMARY Barrel
      WeaponLaunchBone = PRIMARY WeaponA
      ;HideSubObject = HEADLIGHT01
    End
    ConditionState = DAMAGED
      Model = NBGunBattery_D
    End
    ConditionState = REALLYDAMAGED RUBBLE
      Model = NBGunBattery_E
    End
    
    ConditionState = SNOW
      Model = NBGunBattery_S
    End
    ConditionState = DAMAGED SNOW
      Model = NBGunBattery_DS
    End
    ConditionState = REALLYDAMAGED RUBBLE SNOW
      Model = NBGunBattery_ES
    End
    
    ; **************************************************************************************************************************
    ; This block handles every possible case with construction process, selling process, awaiting construction, and sold states
    ; for this draw module
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBGunBattery
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
      Model = NBGunBattery_D
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
      Model = NBGunBattery_E
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
      Model = NBGunBattery_S
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW DAMAGED
      Model = NBGunBattery_DS
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW REALLYDAMAGED
      Model = NBGunBattery_ES
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION
      Model = NONE
    End
    AliasConditionState = AWAITING_CONSTRUCTION DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION REALLYDAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW
    AliasConditionState = AWAITING_CONSTRUCTION SNOW DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW REALLYDAMAGED
    AliasConditionState = SOLD
    AliasConditionState = SOLD DAMAGED
    AliasConditionState = SOLD REALLYDAMAGED
    AliasConditionState = SOLD SNOW
    AliasConditionState = SOLD SNOW DAMAGED
    AliasConditionState = SOLD SNOW REALLYDAMAGED
  
  End
   ; ------------ construction-zone fence -----------------
  Draw = W3DModelDraw ModuleTag_02
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ under-construction scaffolding -----------------
  Draw = W3DModelDraw ModuleTag_03
    AnimationsRequirePower = No
    MinLODRequired = MEDIUM
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = SNOW PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
      ParticleSysBone = Smoke01 BuildUpSnowSmoke
      ParticleSysBone = Smoke02 BuildUpSnowSmoke
      ParticleSysBone = Smoke03 BuildUpSnowSmoke
      ParticleSysBone = Smoke04 BuildUpSnowSmoke
    End
    ConditionState = SNOW NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
      ParticleSysBone = Smoke01 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke02 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke03 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke04 BuildUpNightSnowSmoke
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ being-constructed crane -----------------
  Draw = W3DModelDraw ModuleTag_04
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SOLD
      Model = NONE
    End
    ConditionState = ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5
      Animation = NBBunker_A5.NBBunker_A5
      AnimationMode = LOOP
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5N
      Animation = NBBunker_A5N.NBBunker_A5N
      AnimationMode = LOOP
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5S
      Animation = NBBunker_A5S.NBBunker_A5S
      AnimationMode = LOOP
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5SN
      Animation = NBBunker_A5SN.NBBunker_A5SN
      AnimationMode = LOOP
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  PlacementViewAngle = -45

  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:ChinaHeavyAA
  Side          = ChinaInfantryGeneral
  EditorSorting = STRUCTURE

  Prerequisites
    Object = Infa_ChinaPropagandaCenter
  End

  BuildCost = 1500
  BuildTime = 30.0     ; in seconds

  EnergyProduction = -4
  ExperienceValue = 1200 1200 1200 1200 ; Experience point value at each level

  WeaponSet
    Conditions = None
    Weapon = PRIMARY ChinaGunBatteryWeapon
  End

  VisionRange = 420.0     ; Shroud clearing distance AND targeting range
  ShroudClearingRange = 420

  ArmorSet
    Conditions = None
    Armor = BaseDefenseArmor
    DamageFX = StructureDamageFXNoShake
  End

  CommandSet = ChinaGunBatteryCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect          = GazerTurretSelect
  SoundOnDamaged       = BuildingDamagedStateLight
  SoundOnReallyDamaged = BuildingDestroy
  UnitSpecificSounds
    UnderConstruction = UnderConstructionLoop
    TurretMoveStart   = NoSound
    TurretMoveLoop    = NoSound     ; These aren't playing properly (mdp) TurretMoveLoopLoud
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = STRUCTURE
  KindOf = PRELOAD STRUCTURE SELECTABLE CAN_ATTACK IMMOBILE SCORE FS_BASE_DEFENSE POWERED IMMUNE_TO_CAPTURE

  Body = StructureBody ModuleTag_05
    MaxHealth = 2500.0
    InitialHealth = 2500.0
    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 3500
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 100
  End

  Behavior = AIUpdateInterface ModuleTag_06
    Turret
      ControlledWeaponSlots = PRIMARY
      TurretTurnRate = 90     ; turn rate, in degrees per sec


      TurretPitchRate = 60
      AllowsPitch = Yes
      FiresWhileTurning = Yes
      NaturalTurretPitch = 30     ; this keeps it aimed half way between land and sky
      MinPhysicalPitch = -10
      MinIdleScanInterval = 250     ; in milliseconds
      MaxIdleScanInterval = 2500     ; in milliseconds
      MinIdleScanAngle = 0     ; in degrees off the natural turret angle
      MaxIdleScanAngle = 360     ; in degrees off the natural turret angle
    End
    AutoAcquireEnemiesWhenIdle = Yes
    MoodAttackCheckRate = 250
  End
  
  Behavior = ProductionUpdate ModuleTag_07
    ;nada
  End

  Behavior = DestroyDie ModuleTag_08
  ; nothing
  End

  Behavior = CommandSetUpgrade ModuleTag_09
    CommandSet = ChinaGunBatteryCommandSetUpgrade
    TriggeredBy = Upgrade_ChinaMines
  End

  Behavior = ArmorUpgrade ModuleTag_10
    TriggeredBy = Upgrade_ChinaEMPMines
  End

  Behavior = GenerateMinefieldBehavior ModuleTag_11
    TriggeredBy           = Upgrade_ChinaMines
    MineName              = ChinaStandardMine
    SmartBorder           = Yes
    AlwaysCircular        = Yes

    Upgradable            = Yes
    UpgradedTriggeredBy   = Upgrade_ChinaEMPMines
    UpgradedMineName      = ChinaEMPMine
  End

  Behavior = FXListDie ModuleTag_12
    DeathFX = FX_StructureTinyDeath
  End

  Behavior = CreateObjectDie ModuleTag_13
    CreationList = OCL_LargeStructureDebris
  End

  Behavior = FlammableUpdate ModuleTag_14
    AflameDuration = 5000     ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 5     ; taking this much damage...
    AflameDamageDelay = 500     ; this often.
  End

  Behavior = TransitionDamageFX ModuleTag_15
    ; -------------DESIGNED FOR TINY SIZED FACTION BUILDING TRANSITIONS-------------------
    DamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ; ---------------------------------------------------------------------------------------
    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionTinyExplosion
    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionTinyShockwave
  End

  Behavior = AutoHealBehavior ModuleTag_JunkInTheTrunk01
    HealingAmount = 2
    HealingDelay = 1000 ; msec
    StartsActive = No
    TriggeredBy = Upgrade_ChinaSubliminalMessaging
  End

  Geometry = BOX
  GeometryMajorRadius = 28.0
  GeometryMinorRadius = 28.0
  GeometryHeight = 28.0
  GeometryIsSmall = No
  Shadow = SHADOW_VOLUME
  BuildCompletion = PLACED_BY_PLAYER
End

Object Spec_ChinaGunBattery
  ; *** ART Parameters ***
  SelectPortrait = SNGunBattery_L
  ButtonImage = SNGunBattery

  UpgradeCameo1 = Upgrade_ChinaSubliminalMessaging

  Draw = W3DModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    IgnoreConditionStates = NIGHT
    DefaultConditionState
      Model = NBGunBattery
      Turret = Turret01
      TurretPitch = TurretEL01
      WeaponFireFXBone = PRIMARY WeaponA
      WeaponRecoilBone = PRIMARY Barrel
      WeaponLaunchBone = PRIMARY WeaponA
      ;HideSubObject = HEADLIGHT01
    End
    ConditionState = DAMAGED
      Model = NBGunBattery_D
    End
    ConditionState = REALLYDAMAGED RUBBLE
      Model = NBGunBattery_E
    End
    
    ConditionState = SNOW
      Model = NBGunBattery_S
    End
    ConditionState = DAMAGED SNOW
      Model = NBGunBattery_DS
    End
    ConditionState = REALLYDAMAGED RUBBLE SNOW
      Model = NBGunBattery_ES
    End
    
    ; **************************************************************************************************************************
    ; This block handles every possible case with construction process, selling process, awaiting construction, and sold states
    ; for this draw module
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBGunBattery
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
      Model = NBGunBattery_D
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
      Model = NBGunBattery_E
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
      Model = NBGunBattery_S
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW DAMAGED
      Model = NBGunBattery_DS
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW REALLYDAMAGED
      Model = NBGunBattery_ES
      Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
    End
    ConditionState = AWAITING_CONSTRUCTION
      Model = NONE
    End
    AliasConditionState = AWAITING_CONSTRUCTION DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION REALLYDAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW
    AliasConditionState = AWAITING_CONSTRUCTION SNOW DAMAGED
    AliasConditionState = AWAITING_CONSTRUCTION SNOW REALLYDAMAGED
    AliasConditionState = SOLD
    AliasConditionState = SOLD DAMAGED
    AliasConditionState = SOLD REALLYDAMAGED
    AliasConditionState = SOLD SNOW
    AliasConditionState = SOLD SNOW DAMAGED
    AliasConditionState = SOLD SNOW REALLYDAMAGED
  
  End
   ; ------------ construction-zone fence -----------------
  Draw = W3DModelDraw ModuleTag_02
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_A4
      Animation = NBBunker_A4.NBBunker_A4
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_A4N
      Animation = NBBunker_A4N.NBBunker_A4N
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_A4S
      Animation = NBBunker_A4S.NBBunker_A4S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_A4SN
      Animation = NBBunker_A4SN.NBBunker_A4SN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ under-construction scaffolding -----------------
  Draw = W3DModelDraw ModuleTag_03
    AnimationsRequirePower = No
    MinLODRequired = MEDIUM
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_DAY
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_NIGHT
      ParticleSysBone = Smoke01 BuildUpSmokeChina
      ParticleSysBone = Smoke02 BuildUpSmokeChina
      ParticleSysBone = Smoke03 BuildUpSmokeChina
      ParticleSysBone = Smoke04 BuildUpSmokeChina
    End
    ConditionState = SNOW PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOW
      ParticleSysBone = Smoke01 BuildUpSnowSmoke
      ParticleSysBone = Smoke02 BuildUpSnowSmoke
      ParticleSysBone = Smoke03 BuildUpSnowSmoke
      ParticleSysBone = Smoke04 BuildUpSnowSmoke
    End
    ConditionState = SNOW NIGHT PARTIALLY_CONSTRUCTED
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = MANUAL
      Flags = START_FRAME_LAST
      TransitionKey = UP_SNOWNIGHT
      ParticleSysBone = Smoke01 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke02 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke03 BuildUpNightSnowSmoke
      ParticleSysBone = Smoke04 BuildUpNightSnowSmoke
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBGunBat_SC
      Animation = NBGunBat_SC.NBGunBat_SC
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBGunBat_SC_S
      Animation = NBGunBat_SC_S.NBGunBat_SC_S
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  ; ------------ being-constructed crane -----------------
  Draw = W3DModelDraw ModuleTag_04
    AnimationsRequirePower = No
    DefaultConditionState
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SNOW NIGHT
      Model = None
      TransitionKey = DOWN_DEFAULT
    End
    ConditionState = SOLD
      Model = NONE
    End
    ConditionState = ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5
      Animation = NBBunker_A5.NBBunker_A5
      AnimationMode = LOOP
      TransitionKey = UP_DAY
    End
    ConditionState = NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5N
      Animation = NBBunker_A5N.NBBunker_A5N
      AnimationMode = LOOP
      TransitionKey = UP_NIGHT
    End
    ConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5S
      Animation = NBBunker_A5S.NBBunker_A5S
      AnimationMode = LOOP
      TransitionKey = UP_SNOW
    End
    ConditionState = SNOW NIGHT ACTIVELY_BEING_CONSTRUCTED
      Model = NBBunker_A5SN
      Animation = NBBunker_A5SN.NBBunker_A5SN
      AnimationMode = LOOP
      TransitionKey = UP_SNOWNIGHT
    End
    TransitionState = DOWN_DEFAULT UP_DAY
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_NIGHT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOW
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = DOWN_DEFAULT UP_SNOWNIGHT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE
      AnimationSpeedFactorRange = 1.0 1.0
      Flags = START_FRAME_FIRST
    End
    TransitionState = UP_DAY DOWN_DEFAULT
      Model = NBBunker_AB
      Animation = NBBunker_AB.NBBunker_AB
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_NIGHT DOWN_DEFAULT
      Model = NBBunker_ABN
      Animation = NBBunker_ABN.NBBunker_ABN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOW DOWN_DEFAULT
      Model = NBBunker_ABS
      Animation = NBBunker_ABS.NBBunker_ABS
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
    TransitionState = UP_SNOWNIGHT DOWN_DEFAULT
      Model = NBBunker_ABSN
      Animation = NBBunker_ABSN.NBBunker_ABSN
      AnimationMode = ONCE_BACKWARDS
      AnimationSpeedFactorRange = 2.0 2.0     ; play teardown animations more quickly
      Flags = START_FRAME_LAST
    End
  End
  PlacementViewAngle = -45

  ; ***DESIGN parameters ***
  DisplayName   = OBJECT:ChinaHeavyAA
  Side          = ChinaSpecialWeaponsGeneral
  EditorSorting = STRUCTURE

  Prerequisites
    Object = Spec_ChinaPropagandaCenter
  End

  BuildCost = 1500
  BuildTime = 5 ;30.0     ; in seconds

  EnergyProduction = -4
  ExperienceValue = 1200 1200 1200 1200 ; Experience point value at each level

  WeaponSet
    Conditions = None
    Weapon = PRIMARY ChinaGunBatteryWeapon
  End

  VisionRange = 420.0     ; Shroud clearing distance AND targeting range
  ShroudClearingRange = 420

  ArmorSet
    Conditions = None
    Armor = BaseDefenseArmor
    DamageFX = StructureDamageFXNoShake
  End

  CommandSet = ChinaGunBatteryCommandSet

  ; *** AUDIO Parameters ***
  VoiceSelect          = GazerTurretSelect
  SoundOnDamaged       = BuildingDamagedStateLight
  SoundOnReallyDamaged = BuildingDestroy
  UnitSpecificSounds
    UnderConstruction = UnderConstructionLoop
    TurretMoveStart   = NoSound
    TurretMoveLoop    = NoSound     ; These aren't playing properly (mdp) TurretMoveLoopLoud
  End

  ; *** ENGINEERING Parameters ***
  RadarPriority = STRUCTURE
  KindOf = PRELOAD STRUCTURE SELECTABLE CAN_ATTACK IMMOBILE SCORE FS_BASE_DEFENSE POWERED IMMUNE_TO_CAPTURE

  Body = StructureBody ModuleTag_05
    MaxHealth = 2500.0
    InitialHealth = 2500.0
    ; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
    ; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
    SubdualDamageCap = 3500
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 100
  End

  Behavior = AIUpdateInterface ModuleTag_06
    Turret
      ControlledWeaponSlots = PRIMARY
      TurretTurnRate = 90     ; turn rate, in degrees per sec


      TurretPitchRate = 60
      AllowsPitch = Yes
      FiresWhileTurning = Yes
      NaturalTurretPitch = 30     ; this keeps it aimed half way between land and sky
      MinPhysicalPitch = -10
      MinIdleScanInterval = 250     ; in milliseconds
      MaxIdleScanInterval = 2500     ; in milliseconds
      MinIdleScanAngle = 0     ; in degrees off the natural turret angle
      MaxIdleScanAngle = 360     ; in degrees off the natural turret angle
    End
    AutoAcquireEnemiesWhenIdle = Yes
    MoodAttackCheckRate = 250
  End
  
  Behavior = ProductionUpdate ModuleTag_07
    ;nada
  End

  Behavior = DestroyDie ModuleTag_08
  ; nothing
  End

  Behavior = CommandSetUpgrade ModuleTag_09
    CommandSet = ChinaGunBatteryCommandSetUpgrade
    TriggeredBy = Upgrade_ChinaMines
  End

  Behavior = ArmorUpgrade ModuleTag_10
    TriggeredBy = Upgrade_ChinaEMPMines
  End

  Behavior = GenerateMinefieldBehavior     ModuleTag_Landmine01
    TriggeredBy           = Upgrade_ChinaMines
    MineName              = Spec_ChinaGrinderLandmine
    SmartBorder           = Yes
    AlwaysCircular        = Yes

    Upgradable            = No
  End

  Behavior = FXListDie ModuleTag_12
    DeathFX = FX_StructureTinyDeath
  End

  Behavior = CreateObjectDie ModuleTag_13
    CreationList = OCL_LargeStructureDebris
  End

  Behavior = FlammableUpdate ModuleTag_14
    AflameDuration = 5000     ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 5     ; taking this much damage...
    AflameDamageDelay = 500     ; this often.
  End

  Behavior = TransitionDamageFX ModuleTag_15
    ; -------------DESIGNED FOR TINY SIZED FACTION BUILDING TRANSITIONS-------------------
    DamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ; ---------------------------------------------------------------------------------------
    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionTinySmoke
    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionTinyExplosion
    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionTinyShockwave
  End

  Behavior = BaseRegenerateUpdate ModuleTag_FreeHeals01
  End 

  Geometry = BOX
  GeometryMajorRadius = 28.0
  GeometryMinorRadius = 28.0
  GeometryHeight = 28.0
  GeometryIsSmall = No
  Shadow = SHADOW_VOLUME
  BuildCompletion = PLACED_BY_PLAYER
End